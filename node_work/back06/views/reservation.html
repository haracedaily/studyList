{% extends 'layout.html' %}
{% block style %}
<style>
    .reservation-card {
        max-width: 700px;
        margin: 30px auto;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    .reservation-title {
        font-weight: bold;
        color: #0d6efd;
    }
</style>
{% endblock %}
{% block content %}
<div class="container">
    <div class="card reservation-card">
        <div class="card-body">
            <h2 class="card-title reservation-title mb-4">예약하기</h2>
            <div class="row g-3">
                <div class="col-md-6">
                    <label for="name" class="form-label">고객명</label>
                    <input type="text" class="form-control" id="name" placeholder="김길동" value="홍길동">
                </div>
                <div class="col-md-6">
                    <label for="tel" class="form-label">전화번호</label>
                    <input type="tel" class="form-control" id="tel" name="tel" value="010-9946-6266" required>
                </div>
                <div class="col-md-6">
                    <label for="email" class="form-label">이메일</label>
                    <input type="email" class="form-control" id="email" name="email" value="dron512@naver.com" required>
                </div>
                <div class="col-md-6">
                    <label for="addr" class="form-label">주소</label>
                    <input type="text" class="form-control" id="addr" name="addr" value="대구 달서구" required>
                </div>
                <div class="col-md-6">
                    <label for="date" class="form-label">예약날짜</label>
                    <input type="date" class="form-control" id="date" name="date" value="2025-06-20" required>
                </div>
                <div class="col-md-6">
                    <label for="time" class="form-label">시간</label>
                    <select class="form-select" id="time" name="time" required>
                        <option value="">시간 선택</option>
                        <option value="오전 10시 ~ 오후 1시" selected>오전 10시 ~ 오후 1시</option>
                        <option value="오후 2시 ~ 오후 5시">오후 2시 ~ 오후 5시</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="model" class="form-label">모델</label>
                    <input type="text" class="form-control" id="model" name="model" value="ㅅ삼성" required>
                </div>
                <div class="col-md-6">
                    <label for="capacity" class="form-label">용량</label>
                    <select class="form-select" id="capacity" name="capacity" required>
                        <option value="">용량 선택</option>
                        <option value="1" selected>1톤</option>
                        <option value="2">2톤</option>
                        <option value="3">3톤</option>
                        <option value="4">4톤</option>
                        <option value="5">5톤</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="service" class="form-label">서비스</label>
                    <select class="form-select" id="service" name="service" required>
                        <option value="">서비스 선택</option>
                        <option value="청소" selected>청소</option>
                        <option value="수리">수리</option>
                        <option value="청소+수리">청소+수리</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="remark" class="form-label">비고</label>
                    <textarea class="form-control" id="remark" name="remark" rows="1">ㅋㅋㅋㅋ</textarea>
                </div>
            </div>
            <div class="d-grid mt-4">
                <button class="btn btn-primary btn-lg" id="save">예약하기</button>
            </div>
        </div>
    </div>
    <h2 class="mt-5 mb-3">예약내역</h2>
    <div class="table-responsive">
        <table class="table table-striped align-middle">
            <thead class="table-light">
            <tr>
                <th scope="col">#</th>
                <th scope="col">이메일</th>
                <th scope="col">서비스</th>
                <th scope="col">전화번호</th>
            </tr>
            </thead>
            <tbody>
            {% for item in data %}
            <tr>
                <th scope="row">{{loop.index}}</th>
                <td>{{item.email}}</td>
                <td>{{item.service}}</td>
                <td>{{item.tel}}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
{% block script %}
<script>
    document.getElementById('save').addEventListener('click', function() {
        const name = document.getElementById('name').value;
        const tel = document.getElementById('tel').value;
        const email = document.getElementById('email').value;
        const addr = document.getElementById('addr').value;
        const date = document.getElementById('date').value;
        const time = document.getElementById('time').value;
        const model = document.getElementById('model').value;
        const capacity = document.getElementById('capacity').value;
        const service = document.getElementById('service').value;
        const remark = document.getElementById('remark').value;

        if (!name || !tel || !email || !addr || !date || !time || !model || !capacity || !service) {
            alert("모든 필드를 입력해주세요.");
            return;
        }

        axios.post('/reservation', {
            name: name,
            tel: tel,
            email: email,
            addr: addr,
            date: date,
            time: time,
            model: model,
            capacity: capacity,
            service: service,
            remark: remark
        })
        .then(function(response) {
            console.log("예약이 완료되었습니다.");
            // window.location.reload();
        })
        .catch(function(error) {
            console.error("There was an error!", error);
            // alert("예약에 실패했습니다. 다시 시도해주세요.");
        });
    });
</script>
{% endblock %}